
MKLROOT?=$(shell echo $$MKLROOT)

# PARDISO only
#############################################################################################################
BASE_PATH=/home/x_gaedkelb
#BASE_PATH=/users/lgaedkem

CXX=mpic++  # for kaust
#CXX=CC       # for daint
# O3 flag important!!
CXXFLAGS=-O3 -lpthread -lm -lgomp -lgfortran -fPIC -fopenmp -fPIC -lm #-Wall -llikwid -DLIKWID_PERFMON

# LIBRARIES
LIBPARDISO=-lpardiso700-GNU840-X86-64-RINLA 	#expects the path in .bashrc (LD_LIBRARY_PATH, LIBRARY)
LIBMKL=-L${MKLROOT}/lib/intel64 -lmkl_gf_lp64 -lmkl_gnu_thread -lmkl_core

ARMADILLO=-larmadillo

LIBS=$(LIBPARDISO) $(LIBMKL) $(ARMADILLO)

# INCLUDES
INCEIGEN=-I/usr/include/eigen3
#INCEIGEN=-I$(BASE_PATH)/include/eigen3

INCBFGS=-I$(BASE_PATH)/applications/LBFGSpp/include
#INCCHOLMOD= -I/usr/include/suitesparse

INCLUDES=$(INCEIGEN) $(INCBFGS) #$(INCCHOLMOD)

$(info =============== Library paths ==============)
$(info MKL      : $(MKLROOT))
$(info EIGEN    : $(INCEIGEN))

$(info )
$(info ===== Compiling w/ RGF dummy version =======)

all: call_INLA

call_INLA: call_INLA.o PostTheta.o PardisoSolver.o RGFSolver_dummy.o
	$(CXX) $^ $(LIBS) $(CXXFLAGS) $(DEBUG) -lm -o $@  #$(LDFLAGS) $(LDLIBS) 

call_INLA.o: call_INLA.cpp
	$(CXX) -c $< $(CXXFLAGS) $(INCLUDES) -o $@ 

%.o : %.cpp %.h
	$(CXX) -c $< $(CXXFLAGS) $(INCLUDES) -o $@ 

clean:	
	rm -f *.o call_INLA




